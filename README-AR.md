# نظام المزامنة التلقائية مع Google Sheets

## 📋 نظرة عامة

تم تحديث النظام ليدعم **المزامنة التلقائية** مع Google Sheets! لن تحتاج بعد الآن للنسخ واللصق اليدوي.

## ✨ المميزات الجديدة

- ✅ **إضافة تلقائية**: عند إنشاء طلب جديد، يُرسل تلقائياً إلى Google Sheets
- ✅ **تحديث تلقائي**: عند تعديل حالة الطلب، يُحدث في Google Sheets تلقائياً
- ✅ **نظام احتياطي**: إذا فشل الإرسال التلقائي، يعود للنسخ اليدوي
- ✅ **سهولة الإعداد**: خطوات بسيطة لتفعيل النظام

## 🚀 كيفية تفعيل المزامنة التلقائية

### الطريقة الأولى: راجع الملف التفصيلي
اتبع التعليمات المفصلة في ملف [`GoogleAppsScript-Setup.md`](./GoogleAppsScript-Setup.md)

### الطريقة الثانية: الخطوات السريعة

1. **افتح Google Apps Script**
   - افتح جدول Google Sheets الخاص بك
   - اختر: الإضافات → Apps Script

2. **انسخ الكود**
   - احذف أي كود موجود
   - افتح ملف [`Code.gs`](./Code.gs)
   - انسخ الكود بالكامل والصقه في Apps Script

3. **انشر Web App**
   - اضغط "نشر" → "نشر جديد"
   - اختر "تطبيق ويب"
   - تنفيذ كـ: "أنا"
   - الوصول: "أي شخص"
   - اضغط "نشر"

4. **انسخ الرابط**
   - بعد النشر، ستحصل على رابط مثل:
   ```
   https://script.google.com/macros/s/AKfycby.../exec
   ```

5. **أضف الرابط في الموقع**
   - افتح ملف `index.html`
   - ابحث عن:
   ```javascript
   const GOOGLE_APPS_SCRIPT_URL = '';
   ```
   - ضع الرابط بين العلامتين:
   ```javascript
   const GOOGLE_APPS_SCRIPT_URL = 'رابط_Web_App_هنا';
   ```
   - كرر نفس الخطوة في ملف `index(2).html`

6. **احفظ وجرّب**
   - احفظ التغييرات
   - سجل طلب جديد
   - تحقق من Google Sheets - يجب أن يظهر الطلب تلقائياً!

## 📁 الملفات المضافة

- **`GoogleAppsScript-Setup.md`** - شرح مفصل بالصور والخطوات
- **`Code.gs`** - كود Google Apps Script الجاهز للنسخ
- **`README-AR.md`** - هذا الملف (الدليل السريع)

## 🔄 كيف يعمل النظام؟

### قبل التحديث (الطريقة القديمة):
1. تسجل طلب جديد
2. النظام ينسخ البيانات للحافظة
3. تذهب إلى Google Sheets
4. تلصق البيانات يدوياً

### بعد التحديث (الطريقة الجديدة):
1. تسجل طلب جديد
2. النظام يرسل البيانات تلقائياً إلى Google Sheets
3. **انتهى!** ✅

## ⚙️ التوافق مع النظام القديم

- إذا **لم** تضع رابط Web App، سيعمل النظام بالطريقة القديمة (نسخ يدوي)
- إذا فشل الإرسال التلقائي، يعود تلقائياً للنسخ اليدوي
- لا حاجة لتغيير أي شيء في Google Sheets - نفس الهيكل

## 🛠️ استكشاف الأخطاء

### المشكلة: لا يتم إرسال البيانات تلقائياً
**الحلول:**
- تحقق من رابط Web App صحيح وينتهي بـ `/exec`
- تحقق من أذونات Apps Script
- افتح Console (F12) وتحقق من الأخطاء

### المشكلة: يظهر خطأ "فشل الإرسال التلقائي"
**الحلول:**
- تحقق من اتصال الإنترنت
- تحقق من إعدادات أذونات Google Sheets
- حاول إعادة نشر Web App

### المشكلة: البيانات تُضاف مرتين
**الحل:**
- تحقق من أنك لم تضف الرابط في ملف واحد فقط
- يجب إضافة الرابط في `index.html` و `index(2).html`

## 📞 الدعم

إذا واجهت أي مشكلة:
1. راجع ملف [`GoogleAppsScript-Setup.md`](./GoogleAppsScript-Setup.md)
2. تحقق من Console في المتصفح (F12)
3. تحقق من أذونات Google Apps Script

## 🎯 ملاحظات مهمة

- ✅ الرابط آمن ومخصص لجدولك فقط
- ✅ لا تشارك رابط Web App مع أحد
- ✅ يمكنك إلغاء النشر في أي وقت من Apps Script
- ✅ النظام يدعم 25 عمود (كامل بيانات الطلب)

---

**تم بنجاح! 🎉**
الآن نظامك يعمل بشكل تلقائي بالكامل - لا حاجة للنسخ واللصق اليدوي!
