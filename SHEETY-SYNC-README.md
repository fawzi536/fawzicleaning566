# ูุฒุงููุฉ Sheety - ุฏููู ุงูุชูููู ูุงูุงุณุชุฎุฏุงู

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ููู `sheety-sync.js` ุงูุฐู ูููู ุจูุฒุงููุฉ ุงูุทูุจุงุช ุชููุงุฆูุงู ูุน Sheety API. ูููุฑ ุงูุจุฑูุงูุฌ ุงููุตู ุงููุฒุงูุง ุงูุชุงููุฉ:

### ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ:

1. **ุฅุฑุณุงู ุงูุทูุจุงุช ุชููุงุฆูุงู ุนูุฏ ุฅูุดุงุฆูุง** - ูุชู ุฅุฑุณุงู ุงูุทูุจ ุฅูู Sheety ููุฑ ุญูุธู ูู ุงููููุฐุฌ
2. **ุชุญุฏูุซ ุงูุทูุจุงุช** - ุฅููุงููุฉ ุชุญุฏูุซ ุงูุทูุจุงุช ุงูููุฌูุฏุฉ ุนูู Sheety
3. **ุฌูุจ ุงูุทูุจุงุช ุฏูุฑูุงู** - ูุชู ุฌูุจ ุงูุทูุจุงุช ูู Sheety ูู 30 ุซุงููุฉ ุชููุงุฆูุงู
4. **ุชุญุฏูุซุงุช ุณุฑูุนุฉ ุนุจุฑ ุงูุจูุงูุงุช** - ุฏุนู ุชุญุฏูุซ ุงูุญุงูุฉ ูุงูุฏูุน ุนุจุฑ ุณูุงุช `data-sheety-action`
5. **ูุงุฌูุฉ ุจุฑูุฌูุฉ ุนุงูุฉ** - ููููู ุงุณุชุฎุฏุงู `window.sheetySync` ููุนูููุงุช ุงููุฏููุฉ

---

## ๐ ุงูุชูููู ุงููุทููุจ

### 1. ุชุญุฏูุซ ุฑุงุจุท Sheety

ุงูุชุญ ุงูููู `sheety-sync.js` ูุงุจุญุซ ุนู ูุณู **CONFIGURATION** (ุงูุณุทุฑ 46):

```javascript
const SHEETY_BASE = 'https://api.sheety.co/984c17c54dafbc5e8fe827b90d39f223/orders';
```

**ููุงุญุธุฉ:** ุงูุฑุงุจุท ุงูุญุงูู ุฌุงูุฒ ููุงุณุชุฎุฏุงู. ุฅุฐุง ููุช ุจุญุงุฌุฉ ูุชุบููุฑูุ ุงุณุชุจุฏูู ุจุฑุงุจุท Sheety ุงูุฎุงุต ุจู.

### 2. ุฅุถุงูุฉ ููุชุงุญ ุงูุชูุซูู (Authorization Token) - ุงุฎุชูุงุฑู

ุฅุฐุง ูุงู Sheety API ุงูุฎุงุต ุจู ูุชุทูุจ ุชูุซููุ ูู ุจุฅุถุงูุฉ ุงูููุชุงุญ ูู ููุณ ุงููุณู:

```javascript
const SHEETY_HEADERS = {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer YOUR_TOKEN_HERE'  // ุฃุฒู ุงูุชุนููู ูุฃุถู ุงูููุชุงุญ ููุง
};
```

**ุฎุทูุงุช ุงูุญุตูู ุนูู ููุชุงุญ ุงูุชูุซูู:**
1. ุงูุชุญ ูุดุฑูุนู ูู Sheety
2. ุงุฐูุจ ุฅูู Settings > Authentication
3. ุงูุณุฎ Bearer Token
4. ุงูุตูู ูู ุงูููุฏ ุฃุนูุงู ุจุฏูุงู ูู `YOUR_TOKEN_HERE`

### 3. ุชุทุงุจู ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูู Google Sheets

**ููู ุฌุฏุงู:** ูุฌุจ ุฃู ุชุชุทุงุจู ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูู Google Sheet ูุน ุงูููุงุชูุญ ุงููุณุชุฎุฏูุฉ ูู ุงูููุฏ.

**ุงูุฃุนูุฏุฉ ุงููุชููุนุฉ ูู ุงูุชุฑุชูุจ (ูู ุงููุณุงุฑ ุฅูู ุงููููู):**

| ุฑูู ุงูุนููุฏ | ุงูุงุณู ุงูุฅูุฌููุฒู | ุงูุงุณู ุจุงูุนุฑุจูุฉ (ุงุฎุชูุงุฑู) |
|------------|------------------|-------------------------|
| A | orderNumber | ุฑูู ุงูุทูุจ |
| B | orderDate | ุชุงุฑูุฎ ุงูุทูุจ |
| C | customerNumber | ุฑูู ุงูุนููู |
| D | customerName | ุงุณู ุงูุนููู |
| E | area | ุงูููุทูุฉ |
| F | block | ุงููุทุนุฉ |
| G | street | ุงูุดุงุฑุน |
| H | houseNumber | ุฑูู ุงูููุฒู |
| I | floor | ุงูุฏูุฑ |
| J | housingType | ููุน ุงูุณูู |
| K | locationNotes | ููุงุญุธุงุช ุงููููุน |
| L | serviceType | ููุน ุงูุฎุฏูุฉ |
| M | visitDate | ุชุงุฑูุฎ ุงููุนุงููุฉ |
| N | visitTime | ููุช ุงููุนุงููุฉ |
| O | cleaningDate | ุชุงุฑูุฎ ุงูุชูุธูู |
| P | cleaningTime | ููุช ุงูุชูุธูู |
| Q | paymentMethod | ุทุฑููุฉ ุงูุฏูุน |
| R | totalAmount | ุงููุจูุบ ุงูุฅุฌูุงูู |
| S | paymentStatus | ุญุงูุฉ ุงูุฏูุน |
| T | bookingStatus | ุญุงูุฉ ุงูุญุฌุฒ |
| U | departureTime | ููุช ุงููุบุงุฏุฑุฉ |
| V | customerNotes | ููุงุญุธุงุช ุงูุนููู |
| W | teamNotes | ููุงุญุธุงุช ุงููุฑูู |
| X | customerRating | ุชูููู ุงูุนููู |
| Y | ratingNotes | ููุงุญุธุงุช ุงูุชูููู |
| Z | cancellationReason | ุณุจุจ ุงูุฅูุบุงุก |

**ุฅุฐุง ูุงูุช ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูุฏูู ูุฎุชููุฉ:**
1. ุงูุชุญ `sheety-sync.js`
2. ุงุจุญุซ ุนู ุฏุงูุฉ `buildOrderPayloadFromForm()` (ุงูุณุทุฑ 62)
3. ูู ุจุชุญุฏูุซ ุฃุณูุงุก ุงูููุงุชูุญ ูุชุชุทุงุจู ูุน ุฃุณูุงุก ุฃุนูุฏุชู

**ูุซุงู:**
```javascript
// ุฅุฐุง ูุงู ุนููุฏ "ุงุณู ุงูุนููู" ูุณูู "customer_full_name" ูู Sheety:
customerName: document.getElementById('customer-name').value,
// ุบูุฑู ุฅูู:
customer_full_name: document.getElementById('customer-name').value,
```

### 4. ุถุจุท ูุชุฑุฉ ุงููุฒุงููุฉ (ุงุฎุชูุงุฑู)

ููููู ุชุบููุฑ ูุชุฑุฉ ุฌูุจ ุงูุจูุงูุงุช ูู Sheety (ุงูุงูุชุฑุงุถู 30 ุซุงููุฉ):

```javascript
const POLL_INTERVAL = 30000; // ุจุงููููู ุซุงููุฉ (30000 = 30 ุซุงููุฉ)
```

ูุชุบููุฑูุง ุฅูู ุฏูููุฉ ูุงุญุฏุฉ ูุซูุงู:
```javascript
const POLL_INTERVAL = 60000; // 60 ุซุงููุฉ
```

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุงูุงุณุชุฎุฏุงู ุงูุชููุงุฆู

ุงูุจุฑูุงูุฌ ุงููุตู ูุนูู ุชููุงุฆูุงู ุจูุฌุฑุฏ ุชุญููู ุงูุตูุญุฉ:

1. **ุนูุฏ ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ:**
   - ุงููุฃ ูููุฐุฌ ุงูุทูุจ ุงูุฌุฏูุฏ
   - ุงุถุบุท "ุฅุถุงูุฉ ุทูุจ"
   - ุณูุชู ุฅุฑุณุงู ุงูุทูุจ ุชููุงุฆูุงู ุฅูู Sheety
   - ุณุชุฌุฏ ุงูุทูุจ ูุถุงูุงู ูู Google Sheet

2. **ุฌูุจ ุงูุทูุจุงุช ุชููุงุฆูุงู:**
   - ูุชู ุฌูุจ ุงูุทูุจุงุช ูู Sheety ูู 30 ุซุงููุฉ
   - ูุชู ุชุญุฏูุซ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุชููุงุฆูุงู

### ุงูุงุณุชุฎุฏุงู ุงููุฏูู ุนุจุฑ Console

ููููู ุงุณุชุฎุฏุงู ูุงุฌูุฉ ุงูุจุฑูุฌุฉ ูู Console ุงููุชุตูุญ:

```javascript
// ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ
await window.sheetySync.createOrderOnSheet({
    order: {
        orderNumber: 123,
        customerName: 'ูุญูุฏ ุฃุญูุฏ',
        area: 'ุงูุณุงูููุฉ',
        // ... ุจุงูู ุงูุญููู
    }
});

// ุชุญุฏูุซ ุทูุจ ููุฌูุฏ (ุชุญุชุงุฌ ุฅูู sheety ID)
await window.sheetySync.updateOrderOnSheet(5, {
    paymentStatus: 'ูุฏููุน',
    totalAmount: 50
});

// ุฌูุจ ุฌููุน ุงูุทูุจุงุช
const orders = await window.sheetySync.fetchOrdersFromSheet();
console.log(orders);
```

### ุงุณุชุฎุฏุงู Data Attributes ููุชุญุฏูุซุงุช ุงูุณุฑูุนุฉ

ููููู ุฅุถุงูุฉ ุฃุฒุฑุงุฑ ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ููุชุญุฏูุซุงุช ุงูุณุฑูุนุฉ:

```html
<!-- ุฒุฑ ูุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ -->
<button 
    data-sheety-action="update-status" 
    data-sheety-id="5" 
    data-status="ููุฏ ุงูุชูููุฐ">
    ุชุญุฏูุซ ุงูุญุงูุฉ
</button>

<!-- ุฒุฑ ูุชุญุฏูุซ ุญุงูุฉ ุงูุฏูุน -->
<button 
    data-sheety-action="update-payment" 
    data-sheety-id="5" 
    data-payment-status="ูุฏููุน">
    ุชู ุงูุฏูุน
</button>

<!-- ุฒุฑ ูุชุญุฏูุซ ุทุฑููุฉ ุงูุฏูุน -->
<button 
    data-sheety-action="update-payment-method" 
    data-sheety-id="5" 
    data-payment-method="ูุงุด">
    ูุงุด
</button>
```

---

## ๐ ุงูุฃุญุฏุงุซ ุงููุฎุตุตุฉ (Custom Events)

ูููู ุงูุจุฑูุงูุฌ ุงููุตู ุจุฅุทูุงู ุฃุญุฏุงุซ ููููู ุงูุงุณุชูุงุน ุฅูููุง:

```javascript
// ุนูุฏ ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ
window.addEventListener('sheety:order:created', (e) => {
    console.log('ุชู ุฅูุดุงุก ุทูุจ:', e.detail.order);
});

// ุนูุฏ ุชุญุฏูุซ ุทูุจ
window.addEventListener('sheety:order:updated', (e) => {
    console.log('ุชู ุชุญุฏูุซ ุทูุจ:', e.detail.order);
});

// ุนูุฏ ุฌูุจ ุงูุทูุจุงุช
window.addEventListener('sheety:orders:fetched', (e) => {
    console.log('ุชู ุฌูุจ ุงูุทูุจุงุช:', e.detail.orders);
});
```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ูุชู ุฅุฑุณุงู ุงูุทูุจุงุช ุฅูู Sheety

**ุงูุญููู:**
1. ุชุฃูุฏ ูู ุตุญุฉ ุฑุงุจุท `SHEETY_BASE`
2. ุงูุชุญ Console ูุชุญูู ูู ูุฌูุฏ ุฃุฎุทุงุก
3. ุชุฃูุฏ ูู ุฃู Sheety API ูุนูู (ุงุฎุชุจุฑู ูู Postman)
4. ุชุญูู ูู ุฃู Authorization Token ุตุญูุญ (ุฅู ููุฌุฏ)

### ุงููุดููุฉ: ุฃุณูุงุก ุงูุฃุนูุฏุฉ ุบูุฑ ูุชุทุงุจูุฉ

**ุงูุญู:**
1. ุงูุชุญ Google Sheet ูุชุญูู ูู ุฃุณูุงุก ุงูุฃุนูุฏุฉ ุงููุนููุฉ
2. ุงูุชุญ `sheety-sync.js` ูุนุฏูู `buildOrderPayloadFromForm()`
3. ุชุฃูุฏ ูู ุฃู ุงูุฃุณูุงุก ูุชุทุงุจูุฉ ุชูุงูุงู (ุญุณุงุณุฉ ูุญุงูุฉ ุงูุฃุญุฑู)

### ุงููุดููุฉ: CORS Error

**ุงูุญู:**
- ุชุฃูุฏ ูู ุชูุนูู CORS ูู ุฅุนุฏุงุฏุงุช Sheety
- ูู Sheetyุ ุงุฐูุจ ุฅูู Settings > API
- ูุนูู "Allow CORS" ุฃู ุฃุถู ูุทุงูู ูู Allowed Origins

### ุงููุดููุฉ: ุงูุจูุงูุงุช ูุง ุชูุญุฏุซ ูู ุงููุงุฌูุฉ

**ุงูุญู:**
- ุชุฃูุฏ ูู ูุฌูุฏ ุงูุฏูุงู `window.renderAllOrders` ุฃู `window.applySheetyOrders`
- ุฃู ุงุณุชูุน ููุญุฏุซ `sheety:orders:fetched` ูุญุฏูุซ ุงููุงุฌูุฉ ูุฏููุงู

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุนุฏู ุงูุชุฏุฎู:** ุงูุจุฑูุงูุฌ ุงููุตู ูุง ูุนุฏู ุนูู ุงููุธุงุฆู ุงูููุฌูุฏุฉุ ุจู ูุถูู ุทุจูุฉ ูุฒุงููุฉ ููุท
2. **ุงูุชูุงูู:** ูุนูู ูุน ุงููุธุงู ุงูุญุงูู ุฏูู ุชุนุงุฑุถ
3. **ุงูุฃูุงู:** ูุง ุชุดุงุฑู Authorization Token ูู ุฃูุงูู ุนุงูุฉ
4. **ุงูุฃุฏุงุก:** ุงููุฒุงููุฉ ูู 30 ุซุงููุฉุ ููููู ุชุนุฏูููุง ุญุณุจ ุงูุญุงุฌุฉ
5. **ุงูููุซูููุฉ:** ูู ุญุงูุฉ ูุดู ุงูุฅุฑุณุงูุ ูุชู ุนุฑุถ ุฑุณุงูุฉ ูู Console ุฏูู ุชุนุทูู ุงููุธุงู

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:
1. ุงูุชุญ Console ูู ุงููุชุตูุญ (F12)
2. ุงุจุญุซ ุนู ุฑุณุงุฆู ุงูุฃุฎุทุงุก ุจุงูููู ุงูุฃุญูุฑ
3. ุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช ุงููุฐููุฑุฉ ุฃุนูุงู
4. ุฑุงุฌุน ูุซุงุฆู Sheety API

---

**ุชู ุงูุชุทููุฑ ุจูุงุณุทุฉ:** GitHub Copilot
**ุงูุชุงุฑูุฎ:** 2025-10-15
**ุงูุฅุตุฏุงุฑ:** 1.0.0
